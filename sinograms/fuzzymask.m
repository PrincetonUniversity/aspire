function m = fuzzymask(n,dims,r0,risetime,origin)% function m = fuzzymask(n,dims,r0,risetime[,origin]);% Create a centered 1d, 2d or 3d disc of radius r0, made with an error% function with effective risetime tr.% The old fuzzydisc has an fc argument that corresponds to tr in this way:% fc=0.1 <--> tr=3.3% fc-0.2 <--> tr=1.7% The origin variable is a vector; its default value is n/2+1 in each% element.ctr=n/2+1;  % default center is appropriate for ffts.k=1.782/risetime;switch dims    case 1        if nargin<5            origin = ctr;  % Coordinate of the center        end;        r=abs(-origin(1)+1:n-origin(1))';    case 2        if nargin<5            origin = [ctr ctr]';  % Coordinate of the center        end;        [x,y]=ndgrid(-origin(1)+1:n-origin(1),-origin(2)+1:n-origin(2));        r = sqrt(x.^2 + y.^2);    case 3        if nargin<5            origin = [ctr ctr ctr]';  % Coordinate of the center        end;        [x,y,z]=ndgrid(-origin(1)+1:n-origin(1),-origin(2)+1:n-origin(2), -origin(3)+1:n-origin(3));        r = sqrt(x.^2 + y.^2 + z.^2);    otherwise        error(['Wrong number of dimensions' num2str(dims)]);end;m=0.5*(1-erf(k*(r-r0)));